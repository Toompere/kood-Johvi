# [Malware](https://github.com/01-edu/public/tree/master/subjects/cybersecurity/malware)

⚠️⚠️⚠️ **Only run this program in a VM** ⚠️⚠️⚠️

## Overview

**Malware** is a project where you will develop a basic ransomware program inspired by WannaCry. This is for educational purposes only.

### What is Ransomware?

Ransomware is a type of malicious software designed to block access to a computer system or encrypt files, making them inaccessible until a ransom is paid to the attacker. It typically infiltrates systems through phishing emails, malicious links, or infected websites, then spreads across networks, locking or encrypting valuable data. Once activated, ransomware displays a message demanding payment, often in cryptocurrency, to provide a decryption key or restore access. Paying the ransom does not guarantee data recovery and may encourage further attacks, making prevention and regular data backups essential defense strategies.

### Bypassing Antivirus

This project uses techniques similar to those in the **Evasion** project. When compiling the ransomware, malicious code is encrypted to make its true purpose harder to detect. However, most antivirus programs, including those on VirusTotal and Windows Defender, may not detect it even without encryption or additional evasion measures.

### Encryption

When executed, the program first increments an integer to `100001` and pauses for 2 seconds (a simplified version of **Evasion** to potentially bypass antivirus). It then searches pre-determined directories (the current user’s Desktop and Documents in this exercise) for specific file extensions (.txt, .pdf, .png) and encrypts them using 32-bit AES encryption. The key consists of a pre-determined 16-bit value and a randomly generated 16-bit value upon each execution. After encryption, a ransom note is added to the directory where the program was executed, containing instructions and a decryption key.

### Decryption

To compile the decryption program, you must provide the encryption key as an argument. The program then searches through the same directories for files with the `.mlwr` extension and decrypts them.

## Prerequisites

- **Windows VM**: Tested on Windows 10.
- **Golang**: Required for compiling the program.

### Installation Instructions

1. **Set Up a Windows Virtual Machine**:
   - Install any Windows OS version on a virtual machine.

2. **Compile the Encryption Program**:
   - Compile it either on the VM or your host OS, but only execute it within the VM.
   - Open a terminal, navigate to the project directory, and compile the program with:
     ```bash
     go run malware.go encrypt
     ```
   - Transfer the compiled program to the VM if needed.

3. **Execute the Program**:
   - Run the program on the Windows VM. It should encrypt all `.txt`, `.pdf`, and `.png` files in `/Desktop` and `/Documents`. A **READ THIS.txt** ransom note will appear in the directory where the program was executed.

4. **Compile the Decryption Program**:
   - Copy the key from **READ THIS.txt**.
   - Open a terminal, navigate to the project directory, and compile the program with:
     ```bash
     go run malware.go decrypt <key>
     ```
   - Transfer the compiled program to the VM if needed.

5. **Execute the Decryption Program**:
   - Run the decryption program in the VM. All encrypted files should be restored to their original state.


## Video

Video showing the program in action can be found [here](https://www.youtube.com/watch?v=AHL3ZsdsuZk).

## Audit
 [Audit Questions](https://github.com/01-edu/public/tree/master/subjects/cybersecurity/malware/audit)


## Autor
[MargusT](https://01.kood.tech/git/MargusT)

## Warning
⚠️ These methods and tools are for educational purposes only, so that you have a better understanding of how to protect against similar vulnerabilities. You must ensure that you do not attempt any exploit-type activity without the explicit permission of the owner of the machine, system or application. Failure to obtain permission risks breaking the law.